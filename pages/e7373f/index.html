<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Git使用教程（中） | 五维星空</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <script data-ad-client="ca-pub-4796012552897657" async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <meta name="description" content="全栈修炼之路">
    <meta name="keywords" content="Java全栈博客,个人技术博客,前端,后端,前端开发,后端开发,前端框架,后端框架,web前端,web后端,数据库,前端面试题,后端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown,Java,Spring,SpringBoot,SpringMvc,Docker,MySQL">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.2ceecd60.css" as="style"><link rel="preload" href="/assets/js/app.7a37bc80.js" as="script"><link rel="preload" href="/assets/js/2.fac42ad5.js" as="script"><link rel="preload" href="/assets/js/38.d57bee44.js" as="script"><link rel="prefetch" href="/assets/js/10.a1e48ae4.js"><link rel="prefetch" href="/assets/js/11.901b0833.js"><link rel="prefetch" href="/assets/js/12.9355c718.js"><link rel="prefetch" href="/assets/js/13.571e03c1.js"><link rel="prefetch" href="/assets/js/14.2e8346fd.js"><link rel="prefetch" href="/assets/js/15.844ac9bc.js"><link rel="prefetch" href="/assets/js/16.a70e2a45.js"><link rel="prefetch" href="/assets/js/17.1bc8513f.js"><link rel="prefetch" href="/assets/js/18.7fdaeb9d.js"><link rel="prefetch" href="/assets/js/19.e01293e5.js"><link rel="prefetch" href="/assets/js/20.bd4fc039.js"><link rel="prefetch" href="/assets/js/21.071e1f89.js"><link rel="prefetch" href="/assets/js/22.0b1a4bee.js"><link rel="prefetch" href="/assets/js/23.9b8e252c.js"><link rel="prefetch" href="/assets/js/24.421b90ee.js"><link rel="prefetch" href="/assets/js/25.3fd6c639.js"><link rel="prefetch" href="/assets/js/26.229d0f35.js"><link rel="prefetch" href="/assets/js/27.7a714d6d.js"><link rel="prefetch" href="/assets/js/28.aea70d79.js"><link rel="prefetch" href="/assets/js/29.d237c638.js"><link rel="prefetch" href="/assets/js/3.5e24be4e.js"><link rel="prefetch" href="/assets/js/30.d0f3f208.js"><link rel="prefetch" href="/assets/js/31.33fd097a.js"><link rel="prefetch" href="/assets/js/32.92296070.js"><link rel="prefetch" href="/assets/js/33.12089269.js"><link rel="prefetch" href="/assets/js/34.01034d36.js"><link rel="prefetch" href="/assets/js/35.a08de71d.js"><link rel="prefetch" href="/assets/js/36.e94fda4b.js"><link rel="prefetch" href="/assets/js/37.6943fedf.js"><link rel="prefetch" href="/assets/js/39.ddedd2dc.js"><link rel="prefetch" href="/assets/js/4.6678ed5e.js"><link rel="prefetch" href="/assets/js/40.f14c3770.js"><link rel="prefetch" href="/assets/js/41.230336a4.js"><link rel="prefetch" href="/assets/js/5.7403dcb5.js"><link rel="prefetch" href="/assets/js/6.50f02e13.js"><link rel="prefetch" href="/assets/js/7.eaaa5221.js"><link rel="prefetch" href="/assets/js/8.b0e44506.js"><link rel="prefetch" href="/assets/js/9.f4e9b912.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2ceecd60.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open no-sidebar have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="五维星空" class="logo"> <span class="site-name can-hide">五维星空</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/QuJiaLin/Learning" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatar.png"> <div class="blogger-info"><h3>五维星空</h3> <span>全栈修炼之路</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/QuJiaLin/Learning" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <!----> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=%E5%88%86%E5%B8%83%E5%BC%8F%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9Fgit%E6%95%99%E7%A8%8B" title="分类" data-v-06225672>分布式版本控制系统git教程</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/QuJiaLin" target="_blank" title="作者" class="beLink" data-v-06225672>五维星空</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2021-12-31</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">Git使用教程（中）<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="git-使用教程-中"><a href="#git-使用教程-中" class="header-anchor">#</a> Git 使用教程（中）</h1> <ul><li><a href="#git%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%E4%B8%8B">Git 使用教程（下）</a> <ul><li><a href="#%E5%88%9B%E5%BB%BA%E4%B8%8E%E5%90%88%E5%B9%B6%E5%88%86%E6%94%AF">创建与合并分支</a></li> <li><a href="#%E5%91%BD%E4%BB%A4">命令</a></li> <li><a href="#%E5%90%88%E5%B9%B6%E5%86%B2%E7%AA%81%E5%8F%8A%E8%A7%A3%E5%86%B3">合并冲突及解决</a></li> <li><a href="#%E5%88%86%E6%94%AF%E7%AE%A1%E7%90%86%E7%AD%96%E7%95%A5">分支管理策略</a></li> <li><a href="#bug%E5%88%86%E6%94%AF">Bug 分支</a></li> <li><a href="#feature%E5%88%86%E6%94%AF">feature 分支</a></li> <li><a href="#%E5%A4%9A%E4%BA%BA%E5%8D%8F%E4%BD%9C">多人协作</a></li> <li><a href="#rebase">Rebase</a></li></ul></li></ul> <h2 id="创建与合并分支"><a href="#创建与合并分支" class="header-anchor">#</a> 创建与合并分支</h2> <p>每次提交，Git 都把它们串成一条时间线，这条时间线就是一个分支。在 Git 里，这个分支叫主分支，即<code>master</code>分支。<code>HEAD</code>严格来说不是指向提交，而是指向<code>master</code>，<code>master</code>才是指向提交的，所以，<code>HEAD</code>指向的就是当前分支。
每次提交，<code>master</code>分支都会向前移动一步，这样，随着你不断提交，<code>master</code>分支的线也越来越长。</p> <p><img src="https://i.loli.net/2019/12/25/sc94h3xb86TiLFg.png" alt="图片.png"></p> <p>当我们创建新的分支，例如 dev 时，Git 新建了一个指针叫 dev，指向 master 相同的提交，再把 HEAD 指向 dev，就表示当前分支在 dev 上：</p> <p><img src="https://i.loli.net/2019/12/25/QxDk8ivVNZo3jFp.png" alt="图片.png"></p> <p><strong>举例</strong></p> <p>首先，我们创建<code>dev</code>分支，然后切换到<code>dev</code>分支：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git checkout <span class="token operator">-</span>b dev
Switched to a <span class="token keyword">new</span> branch <span class="token string-literal"><span class="token string">'dev'</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><code>git checkout</code>命令加上<code>-b</code>参数表示创建并切换，相当于以下两条命令:</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git branch dev
$ git checkout dev
Switched to branch <span class="token string-literal"><span class="token string">'dev'</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>然后，用 git branch 命令查看当前分支(当前分支前有个*号)：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git branch
<span class="token operator">*</span> dev
  master
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>然后，我们就可以在 dev 分支上正常提交，比如对<code>readme.txt</code>做个修改，加上一行,然后提交.</p> <p>切换回<code>master</code>分支,发现刚才修改的内容“没有生效”，这是因为那个提交是在<code>dev</code>分支上，而<code>master</code>分支此刻的提交点并没有变：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git checkout master
Switched to branch <span class="token string-literal"><span class="token string">'master'</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://i.loli.net/2019/12/25/8k3LTtsAHPnaSrR.png" alt="图片.png"></p> <p>现在，我们把<code>dev</code>分支的工作成果合并到<code>master</code>分支上：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git merge dev
Updating d46f35e<span class="token operator">..</span>b17d20e
Fast<span class="token operator">-</span>forward
readme<span class="token punctuation">.</span>txt <span class="token operator">|</span> <span class="token number">1</span> <span class="token operator">+</span>
<span class="token number">1</span> file changed<span class="token punctuation">,</span> <span class="token number">1</span> insertion<span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>注：</strong><code>git merge</code>命令用于合并指定分支到当前分支。上面的<code>Fast-forward</code>信息，Git 告诉我们，这次合并是“快进模式”，也就是直接把<code>master</code>指向<code>dev</code>的当前提交，所以合并速度非常快。</p> <p>合并完成后，就可以放心地删除 dev 分支了：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git branch <span class="token operator">-</span>d dev
Deleted branch dev <span class="token punctuation">(</span>was b17d20e<span class="token punctuation">)</span><span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>创建并切换到新的<code>dev</code>分支，可以使用：<code>git switch -c dev</code>
直接切换到已有的<code>master</code>分支，可以使用：<code>git switch master</code></p> <h2 id="命令"><a href="#命令" class="header-anchor">#</a> 命令</h2> <p>查看分支：<code>git branch</code></p> <p>创建分支：<code>git branch &lt;name&gt;</code></p> <p>切换分支：<code>git checkout &lt;name&gt;</code>或者<code>git switch &lt;name&gt;</code></p> <p>创建+切换分支：<code>git checkout -b &lt;name&gt;</code>或者<code>git switch -c &lt;name&gt;</code></p> <p>合并某分支到当前分支：<code>git merge &lt;name&gt;</code></p> <p>删除分支：<code>git branch -d &lt;name&gt;</code></p> <h2 id="合并冲突及解决"><a href="#合并冲突及解决" class="header-anchor">#</a> 合并冲突及解决</h2> <p><strong>冲突：</strong></p> <ol><li>新建分支<code>dev</code>，切换到<code>dev</code>分支并且修改<code>a.txt</code>后<code>add</code>并<code>commit</code></li> <li>切换到<code>master</code>分支，修改<code>a.txt</code>后<code>add</code>并<code>commit</code></li> <li>尝试合并分支出现冲突！</li></ol> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git merge dev
Auto<span class="token operator">-</span>merging a<span class="token punctuation">.</span>txt
<span class="token constant">CONFLICT</span> <span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token operator">:</span> Merge conflict <span class="token keyword">in</span> a<span class="token punctuation">.</span>txt
Automatic merge failed<span class="token punctuation">;</span> fix conflicts <span class="token keyword">and</span> <span class="token keyword">then</span> commit the result<span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="https://i.loli.net/2019/12/25/vEzZM8eDHqtFKAc.png" alt="图片.png"></p> <p><strong>解决方案</strong></p> <p>Git 告诉我们，<code>a.txt</code>文件存在冲突，必须手动解决冲突后再提交。<code>git status</code>也可以告诉我们冲突的文件：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git status
On branch master
Your branch is ahead of <span class="token string-literal"><span class="token string">'origin/master'</span></span> by <span class="token number">2</span> commits<span class="token punctuation">.</span>
  <span class="token punctuation">(</span>use <span class="token string-literal"><span class="token string">&quot;git push&quot;</span></span> to publish your local commits<span class="token punctuation">)</span>

You have unmerged paths<span class="token punctuation">.</span>
  <span class="token punctuation">(</span>fix conflicts <span class="token keyword">and</span> run <span class="token string-literal"><span class="token string">&quot;git commit&quot;</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span>use <span class="token string-literal"><span class="token string">&quot;git merge --abort&quot;</span></span> to abort the merge<span class="token punctuation">)</span>

Unmerged paths<span class="token operator">:</span>
  <span class="token punctuation">(</span>use <span class="token string-literal"><span class="token string">&quot;git add &lt;file&gt;...&quot;</span></span> to mark resolution<span class="token punctuation">)</span>

  both modified<span class="token operator">:</span>   a<span class="token punctuation">.</span>txt

no changes added to commit <span class="token punctuation">(</span>use <span class="token string-literal"><span class="token string">&quot;git add&quot;</span></span> <span class="token keyword">and</span><span class="token operator">/</span><span class="token keyword">or</span> <span class="token string-literal"><span class="token string">&quot;git commit -a&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>再提交：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git add a<span class="token punctuation">.</span>txt
$ git commit <span class="token operator">-</span>m <span class="token string-literal"><span class="token string">&quot;conflict fixed&quot;</span></span>
<span class="token punctuation">[</span>master cf810e4<span class="token punctuation">]</span> conflict fixed
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>合并过程如下图：</p> <p><img src="https://i.loli.net/2019/12/25/my28wz5ZDQl1BaE.png" alt="图片.png"></p> <p>用带参数的<code>git log</code>也可以看到分支的合并情况：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git log <span class="token operator">-</span><span class="token operator">-</span>graph <span class="token operator">-</span><span class="token operator">-</span>pretty<span class="token operator">=</span>oneline <span class="token operator">-</span><span class="token operator">-</span>abbrev<span class="token operator">-</span>commit
<span class="token operator">*</span>   cf810e4 <span class="token punctuation">(</span><span class="token constant">HEAD</span> <span class="token operator">-</span><span class="token operator">&gt;</span> master<span class="token punctuation">)</span> conflict fixed
<span class="token operator">|</span>\
<span class="token operator">|</span> <span class="token operator">*</span> <span class="token number">14096</span>d0 <span class="token punctuation">(</span>dev<span class="token punctuation">)</span> <span class="token constant">AND</span> simple
<span class="token operator">*</span> <span class="token operator">|</span> <span class="token number">5</span>dc6824 <span class="token operator">&amp;</span> simple
<span class="token operator">|</span><span class="token operator">/</span>
<span class="token operator">*</span> b17d20e branch test
<span class="token operator">*</span> d46f35e <span class="token punctuation">(</span>origin<span class="token operator">/</span>master<span class="token punctuation">)</span> remove test<span class="token punctuation">.</span>txt
<span class="token operator">*</span> b84166e add test<span class="token punctuation">.</span>txt
<span class="token operator">*</span> <span class="token number">519219</span>b git tracks changes
<span class="token operator">*</span> e43a48b understand how stage works
<span class="token operator">*</span> <span class="token number">1094</span>adb append <span class="token constant">GPL</span>
<span class="token operator">*</span> e475afc add distributed
<span class="token operator">*</span> eaadf4e wrote a readme file
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>最后，删除<code>dev</code>分支：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git branch <span class="token operator">-</span>d dev
Deleted branch dev <span class="token punctuation">(</span>was <span class="token number">14096</span>d0<span class="token punctuation">)</span><span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="分支管理策略"><a href="#分支管理策略" class="header-anchor">#</a> 分支管理策略</h2> <p>通常，合并分支时，如果可能，Git 会用<code>Fast forward</code>模式，但这种模式下，删除分支后，会丢掉分支信息。</p> <p>如果要强制禁用<code>Fast forward</code>模式，Git 就会在<code>merge</code>时生成一个新的 <code>commit</code>，这样，从分支历史上就可以看出分支信息</p> <p><strong>实战：</strong> 在<code>master</code>分支上合并<code>dev</code>分支:</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git merge <span class="token operator">-</span><span class="token operator">-</span>no<span class="token operator">-</span>ff <span class="token operator">-</span>m <span class="token string-literal"><span class="token string">&quot;merge with no-ff&quot;</span></span> dev
Merge made by the <span class="token string-literal"><span class="token string">'recursive'</span></span> strategy<span class="token punctuation">.</span>
readme<span class="token punctuation">.</span>txt <span class="token operator">|</span> <span class="token number">1</span> <span class="token operator">+</span>
<span class="token number">1</span> file changed<span class="token punctuation">,</span> <span class="token number">1</span> insertion<span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>合并后，我们用<code>git log</code>看看分支历史：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git log <span class="token operator">-</span><span class="token operator">-</span>graph <span class="token operator">-</span><span class="token operator">-</span>pretty<span class="token operator">=</span>oneline <span class="token operator">-</span><span class="token operator">-</span>abbrev<span class="token operator">-</span>commit
<span class="token operator">*</span>   e1e9c68 <span class="token punctuation">(</span><span class="token constant">HEAD</span> <span class="token operator">-</span><span class="token operator">&gt;</span> master<span class="token punctuation">)</span> merge with no<span class="token operator">-</span>ff
<span class="token operator">|</span>\
<span class="token operator">|</span> <span class="token operator">*</span> f52c633 <span class="token punctuation">(</span>dev<span class="token punctuation">)</span> add merge
<span class="token operator">|</span><span class="token operator">/</span>
<span class="token operator">*</span>   cf810e4 conflict fixed
<span class="token operator">...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>不使用<code>Fast forward</code>模式，<code>merge</code>后就像这样：</p> <p><img src="https://i.loli.net/2019/12/25/oe91AjiYupILNKf.png" alt="图片.png"></p> <p><strong>分支策略</strong>
实际开发中，首先，<code>master</code>分支应该是非常稳定的，也就是仅用来发布新版本，平时不能在上面干活；那在哪干活呢？干活都在<code>dev</code>分支上，也就是说，<code>dev</code>分支是不稳定的，到某个时候，比如 1.0 版本发布时，再把<code>dev</code>分支合并到<code>master</code>上，在<code>master</code>分支发布 1.0 版本；</p> <p>你和你的小伙伴们每个人都在<code>dev</code>分支上干活，每个人都有自己的分支，时不时地往<code>dev</code>分支上合并就可以了。所以，团队合作的分支看起来就像这样：</p> <p><img src="https://i.loli.net/2019/12/25/p5lmo2BnHqPLaOV.png" alt="图片.png"></p> <h2 id="bug-分支"><a href="#bug-分支" class="header-anchor">#</a> Bug 分支</h2> <p>修复<code>bug</code>时，我们会通过创建新的<code>bug</code>分支进行修复，然后合并，最后删除；</p> <p>当手头工作没有完成时，先把工作现场<code>git stash</code>一下，然后去修复<code>bug</code>，修复后，再<code>git stash pop</code>，回到工作现场；</p> <p>在<code>master</code>分支上修复的<code>bug</code>，想要合并到当前<code>dev</code>分支，可以用<code>git cherry-pick &lt;commit&gt;</code>命令，把<code>bug</code>提交的修改“复制”到当前分支，避免重复劳动。</p> <p><strong>举例：</strong></p> <p>当你在<code>dev</code>分支工作时，有一个<code>bug</code>需要尽快解决，此时使用<code>git stash</code>保存工作现场，切换到<code>master</code>分支，创建新分支修复：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git checkout master
Switched to branch <span class="token string-literal"><span class="token string">'master'</span></span>
Your branch is ahead of <span class="token string-literal"><span class="token string">'origin/master'</span></span> by <span class="token number">6</span> commits<span class="token punctuation">.</span>
  <span class="token punctuation">(</span>use <span class="token string-literal"><span class="token string">&quot;git push&quot;</span></span> to publish your local commits<span class="token punctuation">)</span>

$ git checkout <span class="token operator">-</span>b issue<span class="token operator">-</span><span class="token number">101</span>
Switched to a <span class="token keyword">new</span> branch <span class="token string-literal"><span class="token string">'issue-101'</span></span>

$ git add readme<span class="token punctuation">.</span>txt
$ git commit <span class="token operator">-</span>m <span class="token string-literal"><span class="token string">&quot;fix bug 101&quot;</span></span>
<span class="token punctuation">[</span>issue<span class="token operator">-</span><span class="token number">101</span> <span class="token number">4</span>c805e2<span class="token punctuation">]</span> fix bug <span class="token number">101</span>
<span class="token number">1</span> file changed<span class="token punctuation">,</span> <span class="token number">1</span> insertion<span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span> deletion<span class="token punctuation">(</span><span class="token operator">-</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>再切换到<code>dev</code>分支。此时，用<code>git stash list</code>命令列出该分支下的所有工作现场：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git stash list
stash@<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token operator">:</span> <span class="token constant">WIP</span> on dev<span class="token operator">:</span> f52c633 add merge
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>工作现场还在，<code>Git</code>把<code>stash</code>内容存在某个地方了，但是需要恢复一下，有两个办法：</p> <p>一是用<code>git stash apply</code>或者<code>git stash apply stash@{0}</code>恢复，但是恢复后，<code>stash</code>内容并不删除，你需要用<code>git stash drop</code>来删除；</p> <p>另一种方式是用<code>git stash pop</code>，恢复的同时把<code>stash</code>内容也删了.</p> <p>修复完成后，因为<code>dev</code>分支是来源于<code>master</code>分支，所以，使用<code>git cherry-pick &lt;提交的版本号&gt;</code>命令，此处版本号为<code>4c805e2</code>，来使<code>dev</code>分支进行同样的提交，避免重复劳动。</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git cherry<span class="token operator">-</span>pick <span class="token number">4</span>c805e2
<span class="token punctuation">[</span>master <span class="token number">1</span>d4b803<span class="token punctuation">]</span> fix bug <span class="token number">101</span>
<span class="token number">1</span> file changed<span class="token punctuation">,</span> <span class="token number">1</span> insertion<span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span> deletion<span class="token punctuation">(</span><span class="token operator">-</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="feature-分支"><a href="#feature-分支" class="header-anchor">#</a> feature 分支</h2> <ul><li><p>开发一个新 feature，最好新建一个分支；</p></li> <li><p>如果要丢弃一个没有被合并过的分支，可以通过 git branch -D <name>强行删除。</name></p></li></ul> <p>添加一个新功能时，你肯定不希望因为一些实验性质的代码，把主分支搞乱了，所以，每添加一个新功能，最好新建一个<code>feature</code>分支，在上面开发，完成后，合并，最后，删除该<code>feature</code>分支。</p> <p>实例：</p> <ol><li>你接到了一个新任务：开发代号为 Vulcan 的新功能，该功能计划用于下一代星际飞船。</li></ol> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git switch <span class="token operator">-</span>c feature<span class="token operator">-</span>vulcan
Switched to a <span class="token keyword">new</span> branch <span class="token string-literal"><span class="token string">'feature-vulcan'</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="2"><li>5 分钟后，开发完毕：</li></ol> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git add vulcan<span class="token punctuation">.</span>py

$ git status
On branch feature<span class="token operator">-</span>vulcan
Changes to be committed<span class="token operator">:</span>
  <span class="token punctuation">(</span>use <span class="token string-literal"><span class="token string">&quot;git reset HEAD &lt;file&gt;...&quot;</span></span> to unstage<span class="token punctuation">)</span>

  <span class="token keyword">new</span> file<span class="token operator">:</span>   vulcan<span class="token punctuation">.</span>py

$ git commit <span class="token operator">-</span>m <span class="token string-literal"><span class="token string">&quot;add feature vulcan&quot;</span></span>
<span class="token punctuation">[</span>feature<span class="token operator">-</span>vulcan <span class="token number">287773</span>e<span class="token punctuation">]</span> add feature vulcan
<span class="token number">1</span> file changed<span class="token punctuation">,</span> <span class="token number">2</span> insertions<span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span>
create mode <span class="token number">100644</span> vulcan<span class="token punctuation">.</span>py
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ol start="3"><li>切回 dev，准备合并,但是此时接到上级命令，因经费不足，新功能必须取消！虽然白干了，但是这个包含机密资料的分支还是必须就地销毁：</li></ol> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git switch dev

$ git branch <span class="token operator">-</span>d feature<span class="token operator">-</span>vulcan
<span class="token symbol">error</span><span class="token operator">:</span> The branch <span class="token string-literal"><span class="token string">'feature-vulcan'</span></span> is <span class="token keyword">not</span> fully merged<span class="token punctuation">.</span>
If you are sure you want to delete it<span class="token punctuation">,</span> run <span class="token string-literal"><span class="token string">'git branch -D feature-vulcan'</span></span><span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="4"><li>销毁失败。Git 友情提醒，<code>feature-vulcan</code>分支还没有被合并，如果删除，将丢失掉修改，如果要强行删除，需要使用大写的<code>-D</code>参数。</li></ol> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git branch <span class="token operator">-</span><span class="token constant">D</span> feature<span class="token operator">-</span>vulcan
Deleted branch feature<span class="token operator">-</span>vulcan <span class="token punctuation">(</span>was <span class="token number">287773</span>e<span class="token punctuation">)</span><span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="多人协作"><a href="#多人协作" class="header-anchor">#</a> 多人协作</h2> <p>当你从远程仓库克隆时，实际上 Git 自动把本地的<code>master</code>分支和远程的<code>master</code>分支对应起来了，并且，远程仓库的默认名称是<code>origin</code>。</p> <p>要查看远程库的信息，用<code>git remote</code>：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git remote
origin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><code>git remote -v</code>查看更详细的信息：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git remote <span class="token operator">-</span>v
origin  git<span class="token variable">@github</span><span class="token punctuation">.</span>com<span class="token symbol">:qujialin</span><span class="token operator">/</span>learn<span class="token punctuation">.</span>git <span class="token punctuation">(</span>fetch<span class="token punctuation">)</span>
origin  git<span class="token variable">@github</span><span class="token punctuation">.</span>com<span class="token symbol">:qujialin</span><span class="token operator">/</span>learn<span class="token punctuation">.</span>git <span class="token punctuation">(</span>push<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>上面显示了可以抓取和推送的 origin 的地址。如果没有推送权限，就看不到 push 的地址。</p> <p><strong>推送分支</strong></p> <p>推送分支，就是把该分支上的所有本地提交推送到远程库。推送时，要指定本地分支，这样，Git 就会把该分支推送到远程库对应的远程分支上：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git push origin master
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果要推送其他分支，比如<code>dev</code>，就改成：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git push origin dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>抓取分支</strong></p> <p>多人协作时，大家都会往<code>master</code>和<code>dev</code>分支上推送各自的修改。</p> <p>创建远程<code>origin</code>的<code>dev</code>分支到本地：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git checkout <span class="token operator">-</span>b dev origin<span class="token operator">/</span>dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>你的小伙伴已经向<code>origin/dev</code>分支推送了他的提交，而碰巧你也对同样的文件作了修改，并试图推送：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ cat env<span class="token punctuation">.</span>txt
env

$ git add env<span class="token punctuation">.</span>txt

$ git commit <span class="token operator">-</span>m <span class="token string-literal"><span class="token string">&quot;add new env&quot;</span></span>
<span class="token punctuation">[</span>dev <span class="token number">7</span>bd91f1<span class="token punctuation">]</span> add <span class="token keyword">new</span> env
<span class="token number">1</span> file changed<span class="token punctuation">,</span> <span class="token number">1</span> insertion<span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span>
create mode <span class="token number">100644</span> env<span class="token punctuation">.</span>txt

$ git push origin dev
To github<span class="token punctuation">.</span>com<span class="token symbol">:michaelliao</span><span class="token operator">/</span>learngit<span class="token punctuation">.</span>git
<span class="token operator">!</span> <span class="token punctuation">[</span>rejected<span class="token punctuation">]</span>        dev <span class="token operator">-</span><span class="token operator">&gt;</span> dev <span class="token punctuation">(</span>non<span class="token operator">-</span>fast<span class="token operator">-</span>forward<span class="token punctuation">)</span>
<span class="token symbol">error</span><span class="token operator">:</span> failed to push some refs to <span class="token string-literal"><span class="token string">'git@github.com:michaelliao/learngit.git'</span></span>
<span class="token symbol">hint</span><span class="token operator">:</span> Updates were rejected because the tip of your current branch is behind
<span class="token symbol">hint</span><span class="token operator">:</span> its remote counterpart<span class="token punctuation">.</span> Integrate the remote changes <span class="token punctuation">(</span>e<span class="token punctuation">.</span>g<span class="token punctuation">.</span>
<span class="token symbol">hint</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'git pull ...'</span></span><span class="token punctuation">)</span> before pushing again<span class="token punctuation">.</span>
<span class="token symbol">hint</span><span class="token operator">:</span> See the <span class="token string-literal"><span class="token string">'Note about fast-forwards'</span></span> <span class="token keyword">in</span> <span class="token string-literal"><span class="token string">'git push --help'</span></span> <span class="token keyword">for</span> details<span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>推送失败，因为你的小伙伴的最新提交和你试图推送的提交有冲突，解决办法也很简单，Git 已经提示我们，先用<code>git pull</code>把最新的提交从<code>origin/dev</code>抓下来，然后，在本地合并，解决冲突，再推送：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git pull
There is no tracking information <span class="token keyword">for</span> the current branch<span class="token punctuation">.</span>
Please specify which branch you want to merge with<span class="token punctuation">.</span>
See git<span class="token operator">-</span>pull<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">for</span> details<span class="token punctuation">.</span>

    git pull <span class="token operator">&lt;</span>remote<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>branch<span class="token operator">&gt;</span>

If you wish to set tracking information <span class="token keyword">for</span> this branch you can <span class="token keyword">do</span> so with<span class="token operator">:</span>

    git branch <span class="token operator">-</span><span class="token operator">-</span>set<span class="token operator">-</span>upstream<span class="token operator">-</span>to<span class="token operator">=</span>origin<span class="token operator">/</span><span class="token operator">&lt;</span>branch<span class="token operator">&gt;</span> dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><code>git pull</code>也失败了，原因是没有指定本地<code>dev</code>分支与远程<code>origin/dev</code>分支的链接，根据提示，设置<code>dev</code>和<code>origin/dev</code>的链接：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git branch <span class="token operator">-</span><span class="token operator">-</span>set<span class="token operator">-</span>upstream<span class="token operator">-</span>to<span class="token operator">=</span>origin<span class="token operator">/</span>dev dev
Branch <span class="token string-literal"><span class="token string">'dev'</span></span> set up to track remote branch <span class="token string-literal"><span class="token string">'dev'</span></span> from <span class="token string-literal"><span class="token string">'origin'</span></span><span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>再<code>pull</code>：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git pull
Auto<span class="token operator">-</span>merging env<span class="token punctuation">.</span>txt
<span class="token constant">CONFLICT</span> <span class="token punctuation">(</span>add<span class="token operator">/</span>add<span class="token punctuation">)</span><span class="token operator">:</span> Merge conflict <span class="token keyword">in</span> env<span class="token punctuation">.</span>txt
Automatic merge failed<span class="token punctuation">;</span> fix conflicts <span class="token keyword">and</span> <span class="token keyword">then</span> commit the result<span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>这回<code>git pull</code>成功，但是合并有冲突，需要手动解决，解决的方法和分支管理中的解决冲突完全一样。解决后，提交，再<code>push</code>：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git commit <span class="token operator">-</span>m <span class="token string-literal"><span class="token string">&quot;fix env conflict&quot;</span></span>
<span class="token punctuation">[</span>dev <span class="token number">57</span>c53ab<span class="token punctuation">]</span> fix env conflict

$ git push origin dev
Counting objects<span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span> done<span class="token punctuation">.</span>
Delta compression using up to <span class="token number">4</span> threads<span class="token punctuation">.</span>
Compressing objects<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> done<span class="token punctuation">.</span>
Writing objects<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token regex-literal"><span class="token regex">/6), 621 bytes | 621.00 KiB/s</span></span><span class="token punctuation">,</span> done<span class="token punctuation">.</span>
Total <span class="token number">6</span> <span class="token punctuation">(</span>delta <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> reused <span class="token number">0</span> <span class="token punctuation">(</span>delta <span class="token number">0</span><span class="token punctuation">)</span>
To github<span class="token punctuation">.</span>com<span class="token symbol">:michaelliao</span><span class="token operator">/</span>learngit<span class="token punctuation">.</span>git
  <span class="token number">7</span>a5e5dd<span class="token punctuation">.</span><span class="token number">.57</span>c53ab  dev <span class="token operator">-</span><span class="token operator">&gt;</span> dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>因此，多人协作的工作模式通常是这样：</p> <div class="language- extra-class"><pre><code>  首先，可以试图用`git push origin &lt;branch-name&gt;`推送自己的修改；

  如果推送失败，则因为远程分支比你的本地更新，需要先用`git pull`试图合并；

  如果合并有冲突，则解决冲突，并在本地提交；

  没有冲突或者解决掉冲突后，再用`git push origin &lt;branch-name&gt;`推送就能成功！
</code></pre></div><p>如果<code>git pull</code>提示<code>no tracking information</code>，则说明本地分支和远程分支的链接关系没有创建，用命令<code>git branch --set-upstream-to &lt;branch-name&gt; origin/&lt;branch-name&gt;</code>。</p> <p>这就是多人协作的工作模式，一旦熟悉了，就非常简单。</p> <h2 id="rebase"><a href="#rebase" class="header-anchor">#</a> Rebase</h2> <p>在上一节我们看到了，多人在同一个分支上协作时，很容易出现冲突。即使没有冲突，后 push 的童鞋不得不先 pull，在本地合并，然后才能 push 成功。</p> <p>每次合并再 push 后，分支变成了这样：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git log <span class="token operator">-</span><span class="token operator">-</span>graph <span class="token operator">-</span><span class="token operator">-</span>pretty<span class="token operator">=</span>oneline <span class="token operator">-</span><span class="token operator">-</span>abbrev<span class="token operator">-</span>commit
<span class="token operator">*</span> d1be385 <span class="token punctuation">(</span><span class="token constant">HEAD</span> <span class="token operator">-</span><span class="token operator">&gt;</span> master<span class="token punctuation">,</span> origin<span class="token operator">/</span>master<span class="token punctuation">)</span> init hello
<span class="token operator">*</span>   e5e69f1 Merge branch <span class="token string-literal"><span class="token string">'dev'</span></span>
<span class="token operator">|</span>\
<span class="token operator">|</span> <span class="token operator">*</span>   <span class="token number">57</span>c53ab <span class="token punctuation">(</span>origin<span class="token operator">/</span>dev<span class="token punctuation">,</span> dev<span class="token punctuation">)</span> fix env conflict
<span class="token operator">|</span> <span class="token operator">|</span>\
<span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">*</span> <span class="token number">7</span>a5e5dd add env
<span class="token operator">|</span> <span class="token operator">*</span> <span class="token operator">|</span> <span class="token number">7</span>bd91f1 add <span class="token keyword">new</span> env
<span class="token operator">|</span> <span class="token operator">|</span><span class="token operator">/</span>
<span class="token operator">*</span> <span class="token operator">|</span>   <span class="token number">12</span>a631b merged bug fix <span class="token number">101</span>
<span class="token operator">|</span>\ \
<span class="token operator">|</span> <span class="token operator">*</span> <span class="token operator">|</span> <span class="token number">4</span>c805e2 fix bug <span class="token number">101</span>
<span class="token operator">|</span><span class="token regex-literal"><span class="token regex">/ /</span></span>
<span class="token operator">*</span> <span class="token operator">|</span>   e1e9c68 merge with no<span class="token operator">-</span>ff
<span class="token operator">|</span>\ \
<span class="token operator">|</span> <span class="token operator">|</span><span class="token operator">/</span>
<span class="token operator">|</span> <span class="token operator">*</span> f52c633 add merge
<span class="token operator">|</span><span class="token operator">/</span>
<span class="token operator">*</span>   cf810e4 conflict fixed
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>总之看上去很乱，有强迫症的童鞋会问：为什么 Git 的提交历史不能是一条干净的直线？</p> <p>其实是可以做到的！</p> <p>Git 有一种称为<code>rebase</code>的操作，有人把它翻译成“变基”。输入<code>git rebase</code></p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git rebase
First<span class="token punctuation">,</span> rewinding head to replay your work on top of it<span class="token operator">...</span>
<span class="token symbol">Applying</span><span class="token operator">:</span> add comment
Using index info to reconstruct a base tree<span class="token operator">...</span>
<span class="token constant">M</span>	hello<span class="token punctuation">.</span>py
Falling back to patching base <span class="token keyword">and</span> <span class="token number">3</span><span class="token operator">-</span>way merge<span class="token operator">...</span>
Auto<span class="token operator">-</span>merging hello<span class="token punctuation">.</span>py
<span class="token symbol">Applying</span><span class="token operator">:</span> add author
Using index info to reconstruct a base tree<span class="token operator">...</span>
<span class="token constant">M</span>	hello<span class="token punctuation">.</span>py
Falling back to patching base <span class="token keyword">and</span> <span class="token number">3</span><span class="token operator">-</span>way merge<span class="token operator">...</span>
Auto<span class="token operator">-</span>merging hello<span class="token punctuation">.</span>py
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>此时用<code>git log</code>再看：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git log <span class="token operator">-</span><span class="token operator">-</span>graph <span class="token operator">-</span><span class="token operator">-</span>pretty<span class="token operator">=</span>oneline <span class="token operator">-</span><span class="token operator">-</span>abbrev<span class="token operator">-</span>commit
<span class="token operator">*</span> <span class="token number">7e61</span>ed4 <span class="token punctuation">(</span><span class="token constant">HEAD</span> <span class="token operator">-</span><span class="token operator">&gt;</span> master<span class="token punctuation">)</span> add author
<span class="token operator">*</span> <span class="token number">3611</span>cfe add comment
<span class="token operator">*</span> f005ed4 <span class="token punctuation">(</span>origin<span class="token operator">/</span>master<span class="token punctuation">)</span> set exit<span class="token operator">=</span><span class="token number">1</span>
<span class="token operator">*</span> d1be385 init hello
<span class="token operator">...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>原本分叉的提交现在变成一条直线了！这种神奇的操作是怎么实现的？其实原理非常简单。我们注意观察，发现 Git 把我们本地的提交“挪动”了位置，放到了<code>f005ed4 (origin/master) set exit=1</code>之后，这样，整个提交历史就成了一条直线。rebase 操作前后，最终的提交内容是一致的，但是，我们本地的<code>commit</code>修改内容已经变化了，它们的修改不再基于<code>d1be385 init hello</code>，而是基于<code>f005ed4 (origin/master) set exit=1</code>，但最后的提交<code>7e61ed4</code>内容是一致的。</p> <p>这就是<code>rebase</code>操作的特点：把分叉的提交历史“整理”成一条直线，看上去更直观。缺点是本地的分叉提交已经被修改过了。</p> <p>最后，通过<code>push</code>操作把本地分支推送到远程：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git push origin master
Counting objects<span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span> done<span class="token punctuation">.</span>
Delta compression using up to <span class="token number">4</span> threads<span class="token punctuation">.</span>
Compressing objects<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> done<span class="token punctuation">.</span>
Writing objects<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token regex-literal"><span class="token regex">/6), 576 bytes | 576.00 KiB/s</span></span><span class="token punctuation">,</span> done<span class="token punctuation">.</span>
Total <span class="token number">6</span> <span class="token punctuation">(</span>delta <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> reused <span class="token number">0</span> <span class="token punctuation">(</span>delta <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token symbol">remote</span><span class="token operator">:</span> Resolving deltas<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> completed with <span class="token number">1</span> local object<span class="token punctuation">.</span>
To github<span class="token punctuation">.</span>com<span class="token symbol">:qujialin</span><span class="token operator">/</span>Learn<span class="token punctuation">.</span>git
  f005ed4<span class="token punctuation">.</span><span class="token number">.7e61</span>ed4  master <span class="token operator">-</span><span class="token operator">&gt;</span> master
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>远程分支的提交历史也是一条直线。如下：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ git log <span class="token operator">-</span><span class="token operator">-</span>graph <span class="token operator">-</span><span class="token operator">-</span>pretty<span class="token operator">=</span>oneline <span class="token operator">-</span><span class="token operator">-</span>abbrev<span class="token operator">-</span>commit
<span class="token operator">*</span> <span class="token number">7e61</span>ed4 <span class="token punctuation">(</span><span class="token constant">HEAD</span> <span class="token operator">-</span><span class="token operator">&gt;</span> master<span class="token punctuation">,</span> origin<span class="token operator">/</span>master<span class="token punctuation">)</span> add author
<span class="token operator">*</span> <span class="token number">3611</span>cfe add comment
<span class="token operator">*</span> f005ed4 set exit<span class="token operator">=</span><span class="token number">1</span>
<span class="token operator">*</span> d1be385 init hello
<span class="token operator">...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>参考链接：</p> <p><a href="https://www.liaoxuefeng.com/wiki/896043488029600/900003767775424">https://www.liaoxuefeng.com/wiki/896043488029600/900003767775424</a></p></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/QuJiaLin/Learning/edit/master/docs/分布式版本控制系统git教程/Git使用教程（中）.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/tags/?tag=git%E6%95%99%E7%A8%8B" title="标签">#git教程</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/10/23, 09:21:14</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/821967/"><div>
            HTML5基础
            <!----></div></a> <span class="date">10-19</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/8db399/"><div>
            11.canvas(others)
            <!----></div></a> <span class="date">10-19</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/d62e6e/"><div>
            10.canvas(合成)
            <!----></div></a> <span class="date">10-19</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:1754530626@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/QuJiaLin" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2022
    <span>五维星空 | Copyright © 2021-2022 5wxk.com 版权所有 增值电信业务经营许可证：<a href="http://beian.miit.gov.cn/" target="_blank">陕ICP备18001624号-3</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.7a37bc80.js" defer></script><script src="/assets/js/2.fac42ad5.js" defer></script><script src="/assets/js/38.d57bee44.js" defer></script>
  </body>
</html>
